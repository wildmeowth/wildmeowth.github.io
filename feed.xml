<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Wild Meowth</title>
    <description>嗨，我是野猫(@WildMeowth)，一名天朝的代码搬运工。现居杭州，在杭州工作。目前处于学习状态。</description>
    <link>http://WildMeowth.github.io/</link>
    <atom:link href="http://WildMeowth.github.io/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Tue, 31 May 2022 16:07:59 +0800</pubDate>
    <lastBuildDate>Tue, 31 May 2022 16:07:59 +0800</lastBuildDate>
    <generator>Jekyll v4.2.2</generator>
    
      <item>
        <title>读《城南旧事》-『初恋』有感</title>
        <description>&lt;h2 id=&quot;城南旧事&quot;&gt;城南旧事&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;“就是这样，我的初恋，也是我最后一次的恋爱。我所恋爱的人娶了我的妹妹。初恋像云雾在山峰的心上游荡，有无数美丽的幻想。在我初恋的梦幻中，是一个肥皂泡，吹开，涨大，飞去，终于破碎了。以后我没有再恋爱过，因为那美丽的初恋已够我咀嚼一生；它虽然没有成功，但确曾使我沉溺在幸福里过。我相信以后不会再有比这更动我心魄的爱情使我沉醉了，那么我今生又有何再求呢？”&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;—— 摘自 《城南旧事》&lt;/p&gt;

&lt;h3 id=&quot;初恋&quot;&gt;初恋&lt;/h3&gt;
&lt;p&gt;这段话是来自于其名为初恋的一章中，作者在南边乡下遇到的一位未曾婚嫁的老女校长向作者讲述的她的初恋故事后说的部分内容。&lt;/p&gt;

&lt;p&gt;这位把自己投身于教育的女校长，在生活中对作者关顾备至，为生活毫无规律的的作者整理衣物，还会在晚上坐在灯下为她缝衣服。这些让作者知道了她不仅是个好校长，更像是个好主妇，倘若结了婚一定是个好母亲，不免让作者很疑惑校长的恋爱故事。&lt;/p&gt;

&lt;p&gt;而在一次交心中校长对着作者说出了这个故事。&lt;/p&gt;

&lt;h3 id=&quot;故事&quot;&gt;故事&lt;/h3&gt;
&lt;details&gt;
&lt;summary&gt;&amp;gt; 点此展开预览&lt;/summary&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;我的双亲情爱逾恒，自从母亲去世后，父亲为了避免睹物伤情，便带了他唯有的两个女儿——我和小妹，迁居到傍燕儿山的这乡下来。&lt;/p&gt;

&lt;p&gt;父亲看中了这块地方，是因为有一年和学生旅行，偶然发现的，不知怎么，他便一心一意要实现在这里买一块地盖房的愿望。他亲自设计造这所红砖的小洋房，原是要和母亲终养天年的，谁知母亲还未及看到它的完成，便撒手先去了。但是父亲仍照原来的意志，辞去半生教授的职务，决心乡居著书。&lt;/p&gt;

&lt;p&gt;我虽然正为失母而悲痛，又突然离开城市，离开熟稔的亲友，到一个陌生的乡下过活，但当我走进这所新居时，不禁给眼前新鲜的景色迷住，蓝天、绿竹、红砖、白墙，配合得这样醒目清心。虽然后来在妹妹出嫁和父亲死后，我孤单地面对粉刷一新的白墙，曾度过一段今生最寂寞的时日，但当初进新屋之时，却是以重整起愉快的心情，领受母亲死后的新生活。&lt;/p&gt;

&lt;p&gt;母亲一死，主妇的责任很快地落到我身上。在她刚死后的一段时间，曾由姑母来同住主持家务。我们决定乡居后，姑母便把一串钥匙交到我的手里，她嘱我应如何勤俭持家，因为我的母亲在父亲一生微薄的收入下，积蓄起两所房屋，并非易事。她又说母亲为我们姊妹用心良苦，因为没有儿子，这两处房屋是要留给我们姊妹俩做嫁妆的，红砖洋房属于我，城里的那栋给妹妹。我当时对于姑母所说并不留心，我虽已在女子师范毕业，但是家庭亲爱的气氛浓厚，使我很少想家庭以外的事情。&lt;/p&gt;

&lt;p&gt;操持家务，我该胜任愉快，因为母亲早已给我留下了好榜样。我记得幼小时候看见母亲腋下的一串钥匙，走起路来嚓嚓作响，是如何地羡慕！有时她遗落在桌上，我便要拿过来玩弄一番，学着母亲的样子，挂在腋下跑来跑去，害得母亲到处找不到。那一串钥匙因为在母亲的腋下磨擦多年，已经光亮圆滑。我从母亲的手中接过来，便很自然地挂在我的腋下了。&lt;/p&gt;

&lt;p&gt;乡居的日子简单多了，父亲在日落以前便完成他的书房工作，用不着像在城里似的，非在夜间才能静心写作读书，也没有那样多的学生来问这问那地扰乱他的清思。他的健康因为来到乡下也明显地有了进步。偶尔有人从城里来看望父亲，都为他能在丧了爱妻后反而红润的面色感到惊异。&lt;/p&gt;

&lt;p&gt;刚搬来的那年，妹妹只有十二岁，我比她大了一倍。我要照应这样小的妹妹和老父，俨然是个小主妇了：缝补一家人的衣袜，教妹妹读书，处理一切琐碎的家务。不久以后妹妹考入城里的女子中学，住在宿舍里，一星期回来一次，这期间只有我和父亲，还有老仆张同。但是逢到寒暑假期，妹妹回来，有了这个活泼的小姑娘待在家里，我们就热闹多了。&lt;/p&gt;

&lt;p&gt;溽暑的午后，寂静如睡，父亲在书房里一手扇着芭蕉叶，一手握笔疾书，天气闷热，大家挥汗如雨。可是他因为专心在书案的工作，从不觉得身外的事务与他有何关系，他对写作的兴趣这样浓厚。&lt;/p&gt;

&lt;p&gt;我则常在这个时候带着小妹在竹林为墙的幽径中乘凉，听她的小嘴讲出来那些学校的生活，我们大笑着。好像唯有小妹在家，才能打破一段过去的沉寂生活。&lt;/p&gt;

&lt;p&gt;当炊烟袅袅而上，会合着暮霭，云烟不分的时候，父亲放下了笔，从书房出来，领着妹妹到田间散步，我则收拾起活计或书本，到厨房去督促老张预备晚饭。他们散步回来，大家便坐在院中晚饭，我们在饭桌上看着乌鸦归巢，呱呱呱呱地乱噪一阵，在乡间，这是夜幕垂下前的先声。乌鸦过去了，天暗下来，四籁堕入寂静。虽然也有远处传来几下汽笛呜呜声，划破长空的寂寞。掌灯不久便该休息了。我为父亲的卧室驱蚊，落帐，整理床铺。父亲虽然没有了母亲，并没有改变他生活上的一切习惯。&lt;/p&gt;

&lt;p&gt;早晨如果有空闲，我也常随着父亲领着妹妹出去走走，踏着露水未干的野草，闻着清晨湿土的气味，很是舒服。&lt;/p&gt;

&lt;p&gt;冬日像虫一样的蜷伏在屋子里，和外面接触的生活更少。春天来了，翻开隔年的干叶和杂草，我也喜欢做种植的工作。日子就是天天如此，年年如此，迎春送冬地也不知不觉在乡下四易寒暑了。最初的一两年，不但父亲常带我们到城里去购买书籍物品，城里的亲友和学生们，也时常结伴到乡下来小住盘桓。可是后来父亲渐渐安于乡居懒得进城去，亲友们来看望父亲的也比不了前两年，我们渐渐被人们淡忘了。&lt;/p&gt;

&lt;p&gt;姑妈却照例在每年的清明节前到乡下来。这一年她见了我便惊讶地说：“芳儿，你瘦了！”我没有觉得，摸摸自己的下巴，然后笑笑说：“是吗？我并没有生病呀！”&lt;/p&gt;

&lt;p&gt;姑妈的神情仿佛也不同于往年，她常常注视着我，又有时和父亲谈些什么不愿让我们听见的事情。有一天我走到后院的厨房，听姑妈在和老张说话：“老太爷糊涂，总得张罗张罗，不能让大小姐伺候他一辈子呀！……”窃听的滋味很不好受，我赶紧绕过前院去。心里可打了一个结，是姑妈要给父亲续弦吗？她看我瘦了，以为我操持家事累的吧？但是我决没有这种意思，自己的父亲，自己的家，责无旁贷，怎么能谈到累不累呢！我觉得姑妈有点误会我了。但是，真要为父亲续弦的话，当然没什么不好，不知道姑妈看中了什么人，怪不得常跟父亲嘀嘀咕咕地谈话。&lt;/p&gt;

&lt;p&gt;又有一天，我们闲谈着，那天妹妹也从学校返家。姑妈看着我，却回过头去问小妹：“兰儿，你今年十几啦？”“十六了，姑妈！”我顺口接过回答，但是说出来我又后悔了，我忽然意识到姑妈实在不是要知道小妹的年龄，而是想借此算算我的年龄吧！我也知道姑妈所以不愿直接问我的缘故，是因为我已经不小了——二十八岁了。&lt;/p&gt;

&lt;p&gt;姑母回城里去，小妹又回学校，这里更无聊了，我大半天坐在自己房里看书，慢慢打发光阴。小妹倒是不知寂寞的滋味，她虽然十六岁，依然十足孩子气，回家总约了邻家的女孩上山爬树，各处乱跳。&lt;/p&gt;

&lt;p&gt;快到暑假时，父亲突然告诉我们一个令人兴奋的消息，说是他的一个已经在大学做了助教的学生，预备来此度假，因为父亲有些著作需要他帮忙整理。他要我把客房收拾清洁，扫榻待客。我们这里自从姑母走后，好久没有客人来了，这怎么能不令人兴奋呢！&lt;/p&gt;

&lt;p&gt;终于这位仪表堂堂的青年来了，父亲为我们介绍后，便对他说：“云生，你要像在家里一样，不要客气，要什么尽管对芳儿讲好了。”他很礼貌地向我鞠着深躬，我手足无措，还礼不迭。&lt;/p&gt;

&lt;p&gt;家里有了客人，生活紧张起来了。对于和青年男子的交际，虽然二十八岁的我，仍然不太习惯。他很客气地随着小妹叫我芳姐，随着我管兰儿也叫小妹。可是小妹叫他云哥，我不敢；小妹随便出入他的居室，我也不敢。虽然他的居室差不多每天都是我去亲自为他打扫整理的，我只乘他在父亲书房或同父亲妹妹出外散步时才进去，把蚊帐落下，蚊香点起，小心仔细地把零乱的书桌整理好。如果他一天待在自己房间没出去的话，我便难为情不进去了。其实，以往来这里的客人，都是由我来招呼的，但是没有一次使我像这次的不自然。我有时想，这个青年来得蹊跷，父亲并不需人帮助工作；同时姑妈今年春天对我的神情，……或许……我脸发热，心通通地跳着。&lt;/p&gt;

&lt;p&gt;小妹和云哥已经很熟了，但是我仍然和他保持一段礼貌上的距离。这段距离我宁愿保持着，因为我相信在这中间有一种难以形容的游丝在交织颤动着；因了它，使我享受到在默默中回味、心跳、脸红，以及心灵被这些情感牵制得难以成眠的快乐。&lt;/p&gt;

&lt;p&gt;有一天，当我又在他和父亲出去散步的时候，走进他的居室。香烟和汗垢的气味，从我为他整理的枕褥散发出来，我心想，和爸爸一样，独身男子的房间总有一股怪味道，闻着这股怪味，我亲切地微笑着。正在这时，他气喘喘地跑回来了，他一进来看见我正为他整理床铺，便急忙过来按住我的手，夺去我手中的被，红着脸说：“怎么好麻烦你，芳姐，我自己来……”无意中接触着一个青年男子的巨大而温热的手掌，我的脸又因了血液的冲击而发热了。他也好像怪自己的猛撞，难为情地笑着说：“我来给老师找一张地图……”我帮着他找，才把两人间局促的神情掩饰过去了。&lt;/p&gt;

&lt;p&gt;第二天小妹跑来对我说：“云哥说，他怪不好意思的，不知道原来每天是你替他打扫房屋，他一直以为是老张。”我怕要被淘气的小妹取笑，便一本正经地说：“你告诉云哥不要客气，咱们家来了客人，不都是我招呼吗？”其实我这次的心情，显然是跟往日不同的。&lt;/p&gt;

&lt;p&gt;小妹成了我们的传话筒，他要什么东西，总是叫妹妹带了话来：“云哥问你借一支毛笔。”“云哥问你可有信纸？”“云哥说你的字真漂亮。”“云哥说你是好姐姐。”他好像在妹妹那里探听了更多关于我的琐事。&lt;/p&gt;

&lt;p&gt;有一次我看见小妹和他立在院中花圃前谈话，见我来便不说了，小妹对我局促地笑着，我想她不定又和他在说我什么。回到房里，我便问小妹：“坏丫头，你又在和云哥说什么来着？”她脸一红跑了。她这张淘气的小嘴，不要在云哥面前把我说得太多呀，那是很难为情的事。&lt;/p&gt;

&lt;p&gt;我从小妹嘴里，也知道他许多事。知道了他喜欢吃什么菜，我便每天亲自到离家很远的市上去买来。夏天的早晨，路旁闪耀着露珠的青草，甜蜜而清香，每一条小路我都想走过，我不嫌路远！我要告诉每一棵草，我是什么心情。太阳晒得我出汗，并且告诉我初恋是这样温暖。&lt;/p&gt;

&lt;p&gt;父亲忽然有一天向我们说：“为什么不带云生到燕儿山去看看呢？芳儿也去吧！明天正好我要到城里去，放你们三个一天假好了。”&lt;/p&gt;

&lt;p&gt;第二天我们送走了父亲后，我赶着预备了三份野餐，便一同去燕儿山。到了那块因燕形的岩石而出名的半山上，我们坐下来休息用餐。在大自然下，我也不像在家里那样拘束不安了，和他有了比较自然的说笑。吃完以后，小妹又提议前进，因为再向高处去的山上，开了各种山花，可以采回来插瓶。可是我已经无力前进了，让他们俩去山上跑跑，我需要独自安静一会儿。&lt;/p&gt;

&lt;p&gt;我一头躺在草地上，张开了两臂，任清风饱吻着我的全身。我好像躺在荷叶里的一粒水珠，荡动着，轻漾着。我感觉大空之下任何东西都是美丽的。身边不知名的野花亲热着我，每个从我上空经过的云朵，都寄托了我的梦想。我想，父亲和姑妈安排这青年到这里来的用意安在，感激我的长辈，为了我的幸福多方打算。唉！他会是我的终身伴侣，我将无限地依赖着他。我们将同室而居，我不知我会有几个……我是这样地喜爱孩子！啊！我太放肆了！我怎么可以想到这样令人脸红的事呢！&lt;/p&gt;

&lt;p&gt;他们俩跑得涨红了脸回来，妹妹从他手里摘下两朵红花插在我的鬓边，他擦着汗，微笑地在一旁看着，我不由得低下头来，好像刚才那一段放肆的梦想会被他看透似的。&lt;/p&gt;

&lt;p&gt;日子在快乐中逝去就要嫌短，每年感觉漫长的暑假，今年竟短了许多。在一天的午饭桌上，他告诉我们，明天就要回城里去，因为学校就要开学了。听了这样的话，只有父亲点点头表示知道了，我虽低头默默地吃着饭，心中却思潮起伏。连平日多嘴的小妹，也难得没有开口，我想大概这位青年客人给这一家人带来不同的快乐，如今他要把快乐带走了，当然使人人依依惜别。因为他走后，这里又会沉入如何的寂寞啊！&lt;/p&gt;

&lt;p&gt;午饭以后，父亲照例要睡个中觉，整栋房子静悄悄的。我坐在桌前看书，希望把纷扰的心情压制下去，可是无论如何做不到。&lt;/p&gt;

&lt;p&gt;小妹忽然掀帘进来了，在我一旁坐下，露出她从未有过的一副沉默的神态。她手搭在我肩膀上说：&lt;/p&gt;

&lt;p&gt;“芳姐，云哥要走了！”&lt;/p&gt;

&lt;p&gt;“哦——”我故意若无其事地回笑。&lt;/p&gt;

&lt;p&gt;“两个月过得真快啊！”&lt;/p&gt;

&lt;p&gt;我又没有做声。&lt;/p&gt;

&lt;p&gt;“姐姐，你在想什么？”&lt;/p&gt;

&lt;p&gt;“看书呀！”&lt;/p&gt;

&lt;p&gt;“姐姐，我问你，你说云哥这个人好吗？”她更靠近我。&lt;/p&gt;

&lt;p&gt;“你问这话是什么意思？”我瞪了她一眼。&lt;/p&gt;

&lt;p&gt;“没什么，我就是想知道你对他的印象怎么样。”她把身子一扭，仍是那副矫情的样子。&lt;/p&gt;

&lt;p&gt;这小女孩又来打趣我吗？或许是她转达了云哥的意思吗？我想到这里脸又热起来，但仍装出平静的样子说：“他总是个受大家欢迎的客人。”&lt;/p&gt;

&lt;p&gt;妹妹听了，撅起嘴说：“姐姐说话真不痛快。”&lt;/p&gt;

&lt;p&gt;是的，对于妹妹的一张没遮拦的快嘴，难道我还敢痛痛快快地说出我正恋爱着他，我正为离情所困扰吗？&lt;/p&gt;

&lt;p&gt;小妹没头没脑地来了，又走了。我继续把沉思放在字迹难认的书本上。&lt;/p&gt;

&lt;p&gt;窗外忽然又传来了脚步声，“芳姐在午睡吗？”是他轻敲着窗子在问。&lt;/p&gt;

&lt;p&gt;“没有，要什么东西吗？”我站起来表面平静地这样对他说，心却喜悦地跳动着。&lt;/p&gt;

&lt;p&gt;他走到门前，隔着竹帘讷讷地说：“芳姐，我——我要跟你谈谈，可以吗？”我还不知道应当怎么回答，他又说：“我在竹墙外等您，好吗？”我点点头，他去了。我坐回椅子上，发了一阵呆。&lt;/p&gt;

&lt;p&gt;和我谈谈，我已经意会到那谈谈的意思，怎使我不心慌？我知道他要说的，要求的，我也知道幸福是什么滋味。不过幸福也不要来得太早啊！那会使人忍受不住的。我将怎样回答他所谈的问题？他会怎样向我说呢？时间是这样地短促！&lt;/p&gt;

&lt;p&gt;在竹墙外，我们无意地向前漫步着，他还没有开口，已经紧张得在擦额上的汗珠，我也可以听得出自己一颗鼓动的心声。慢慢地，我们走到一株大树阴下，它足够遮住我俩的热情。他低下头，结结巴巴地说：&lt;/p&gt;

&lt;p&gt;“我要求芳姐一件事……”&lt;/p&gt;

&lt;p&gt;——是什么事，说啊！我的心要从喉咙里跳出来了。既然能开门见山地说，怎么又半途接不上了呢！&lt;/p&gt;

&lt;p&gt;“芳姐，您一定肯帮我们的忙……”&lt;/p&gt;

&lt;p&gt;——帮“我们”的忙？&lt;/p&gt;

&lt;p&gt;“就是——就是，求芳姐跟老师说，我跟小妹的事。”&lt;/p&gt;

&lt;p&gt;跟小妹？……乌云遮住了半个天！&lt;/p&gt;

&lt;p&gt;“希望老师能答应我向小妹求婚，芳姐也许知道了。……”&lt;/p&gt;

&lt;p&gt;我怕支持不住了，将肩头靠在大树干上，我不知道他又喃喃地接着说了些什么，只这样就够了，够了，够了，我不住地点着头。&lt;/p&gt;

&lt;p&gt;我像是从半空上被扔了下来，向下沉，沉，沉，四周的空气压迫着我，我难以形容当时的感觉，我的思潮中只有一个问题：他爱的竟是妹妹，怎么能够！她才十六岁！她还是个背着书包上学的小姑娘，她走路还要踢着路旁的小石子玩耍，她是个连自己的辫子都扎不好的女孩子！&lt;/p&gt;

&lt;p&gt;但是我努力把紊乱的心潮压制下来。我的教养使我爱我家庭中的每一个人，更爱我幼小的妹妹。&lt;/p&gt;

&lt;p&gt;晚上，我仍如往日那样机械地把父亲的床铺整理好，然后我轻轻走到父亲面前，替我恋爱的人向妹妹求婚。父亲一听愣住了，“哦？——”他迷惘地看着我，我低下头去。&lt;/p&gt;

&lt;p&gt;父亲在屋里来回地踱着，我知道这出乎意外的求婚对象，使父亲无措了。久久的沉默，我不得不再为他们解释说：&lt;/p&gt;

&lt;p&gt;“他们俩都有这番意思了。”&lt;/p&gt;

&lt;p&gt;父亲似乎痛苦地望着我，说：“可是，芳儿……”&lt;/p&gt;

&lt;p&gt;我不愿父亲再提到旁的，不等他老人家说下去，我便截住说：&lt;/p&gt;

&lt;p&gt;“你就答应了吧！”&lt;/p&gt;

&lt;p&gt;父亲终于点点头，我退出去，听见父亲在我背后长长地叹着气。&lt;/p&gt;
&lt;/details&gt;

&lt;h3 id=&quot;感想&quot;&gt;感想&lt;/h3&gt;

&lt;p&gt;文中的女校长52岁依旧没结婚，其中缘由似乎来自于她28岁的一段经历，&lt;/p&gt;

&lt;p&gt;青年在这个时间点的出现，让她浮想联翩；&lt;/p&gt;

&lt;p&gt;小心翼翼保持的距离，让她又害羞又雀跃；&lt;/p&gt;

&lt;p&gt;替他整理房间，为他去很远的市买他喜欢吃的菜，甚至哪怕看到路边的野草，天空中的太阳，都让她感觉恋爱的温暖。&lt;/p&gt;

&lt;p&gt;这段让女校长咀嚼了一生的爱恋，没有互道喜欢，没有海誓山盟，实际有的只是暗自的欢喜，以及为小妹做的嫁衣。&lt;/p&gt;

&lt;p&gt;从最初为他收拾房间到最后为他向父亲要妹妹，她和他相处的这短暂时间，从来不是两个人的相处，却还是让校长24年里每每想起都感到沉醉。&lt;/p&gt;

&lt;p&gt;仿佛很美好。&lt;/p&gt;

&lt;p&gt;但看起来美好的暗恋，事实上啥也不是，靠着回忆来品尝爱情的滋味，你回忆的不是他这个人，你回忆的是这种暗恋的感觉。&lt;/p&gt;

&lt;p&gt;若初恋只是一个人的暗恋，可能也是美好的，但一定是难过的。不管这种感情的时间是两个月也好，两年还是五年十年，最好的选择一定是走出来，而不是留恋这一种感觉。&lt;/p&gt;

&lt;p&gt;只能感叹一句，真是想多了你。洗洗睡吧。&lt;/p&gt;
</description>
        <pubDate>Wed, 25 May 2022 15:32:24 +0800</pubDate>
        <link>http://WildMeowth.github.io/2022/05/after-reading-my-memories-of-old-beijing/</link>
        <guid isPermaLink="true">http://WildMeowth.github.io/2022/05/after-reading-my-memories-of-old-beijing/</guid>
        
            
            <category>Love</category>
          
        
        
        <category>Book</category>
        
      </item>
    
      <item>
        <title>在windows 自带虚拟化工具hyper-v 下对Ubuntu 虚拟机分辨率的设置</title>
        <description>&lt;h2 id=&quot;解决方法&quot;&gt;解决方法&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;进入Ubuntu 后 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vi /etc/default/grub&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;将&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet splash&quot;&lt;/code&gt; 改为 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet splash video=hyper_fb:1920x1080&quot;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;更新grub 配置 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo update-grub&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;重启生效&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;过程&quot;&gt;过程&lt;/h2&gt;
&lt;p&gt;最近由于换了新电脑，发现原本使用的虚拟工具virtual box 在新CPU下不是很适配。发现Windows 系统自带hyper-v 也能启动虚拟机的作用。&lt;/p&gt;

&lt;p&gt;使用vboxmanager 将原本ova 镜像转为vhd 就能在hyper-v 中管理使用了，愉快。&lt;/p&gt;

&lt;p&gt;然而，hyper-v 仅对虚拟机内容为Windows 10的虚拟机有增强效果。。。（可恶，我Windows下还装Windows镜像，不能说鸡肋只能说可惜），于是在Ubuntu中面临的一个问题就是显示分辨率的问题。&lt;/p&gt;

&lt;p&gt;导入虚拟机，打开控制台，键入&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xrandr&lt;/code&gt; 发现分辨率仅支持1152 x 864。&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;wildmeowth@wildmeowth-VirtualBox:~$ xrandr
xrandr: Failed to get size of gamma for output default
Screen 0: minimum 1152 x 864, current 1152 x 864, maximum 1152 x 864
default connected primary 1152x864+0+0 0mm x 0mm
   1152x864       0.0* 

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;尝试常规的 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vi /etc/profile&lt;/code&gt; 在配置末尾键入（其实就是想要个16:9）&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;xrandr --newmode &quot;1920x1080_60.00&quot;  173.00  1920 2048 2248 2576  1080 1083 1088 1120 -
xrandr --newmode &quot;1920x1080_60.00&quot;
xrandr --addmode &quot;1152x648_60.00&quot;   59.25  1152 1200 1312 1472  648 651 656 674 -
xrandr --addmode &quot;1152x648_60.00&quot;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;保存好后跑&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;source /etc/profile&lt;/code&gt;使其立即生效
加了两个新的16:9 mode，果然还是不行。&lt;/p&gt;

&lt;p&gt;最终发现可以通过grub的配置来更新分辨率，操作如置顶。&lt;/p&gt;

</description>
        <pubDate>Fri, 25 Mar 2022 20:50:24 +0800</pubDate>
        <link>http://WildMeowth.github.io/2022/03/hyperv-for-ubuntu/</link>
        <guid isPermaLink="true">http://WildMeowth.github.io/2022/03/hyperv-for-ubuntu/</guid>
        
            
            <category>分辨率</category>
          
        
        
        <category>hyper-v</category>
        
      </item>
    
      <item>
        <title>排查：进程</title>
        <description>&lt;p&gt;上篇在查看多线程死锁问题的时候，我们用到了jstack命令。Linux有一些相关的命令可以查看进程情况，本文做一下稍微的记录。&lt;/p&gt;

&lt;p&gt;简单写段代码造成CPU满，和前文中的筷子类联动下（不用白不用）&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;App&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
			&lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cs1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;top 命令 - 直接一个top命令，看到 PID为4832的这个进程把CPU跑满了&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;top - 09:16:54 up 22 min,  2 users,  load average: 1.05, 1.15, 0.86
Tasks: 193 total,   2 running, 191 sleeping,   0 stopped,   0 zombie
%Cpu(s): 39.8 us,  0.8 sy,  0.0 ni, 59.4 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem:   8175896 total,  2947052 used,  5228844 free,    90280 buffers
KiB Swap:  4191228 total,        0 used,  4191228 free.  1069516 cached Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                                                                  
 4832 wildmeo+  20   0 4296188  31944  16424 S 100.2  0.4   1:46.70 java                                                                                                                                     
 2132 wildmeo+  20   0 1450044 218880  66640 S  15.1  2.7   6:42.40 compiz                                                                                                                                   
 1077 root      20   0  457804 139540  38524 S   5.2  1.7   1:34.39 Xorg                                                                                                                                     
 4807 wildmeo+  20   0  587904  30652  23516 S   2.6  0.4   0:00.83 gnome-terminal                                                                                                                           
 1840 wildmeo+  20   0  123408   3188   2800 S   0.4  0.0   0:02.20 VBoxClient                                                                                                                               
 4575 wildmeo+  20   0 5799608 675708  70524 S   0.4  8.3   2:02.68 java                                                                                                                                     
 4851 wildmeo+  20   0   29152   3384   2864 R   0.4  0.0   0:00.18 top                                                                                                                                      
后边进程省略
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;ps 命令 - 跑一把ps命令可以看到其具体出问题的线程&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;命令&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ps -mp 4832 -o THREAD,tid,time &lt;/code&gt;， 查询得到线程TID 4834&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;wildmeowth@wildmeowth-VirtualBox:~$ ps -mp 4832 -o THREAD,tid,time
USER     %CPU PRI SCNT WCHAN  USER SYSTEM   TID     TIME
wildmeo+ 99.3   -    - -         -      -     - 00:02:46
wildmeo+  0.0  19    - futex_    -      -  4832 00:00:00
wildmeo+ 99.2  19    - -         -      -  4834 00:02:46
wildmeo+  0.0  19    - futex_    -      -  4835 00:00:00
wildmeo+  0.0  19    - futex_    -      -  4840 00:00:00
wildmeo+  0.0  19    - futex_    -      -  4841 00:00:00
wildmeo+  0.0  19    - futex_    -      -  4842 00:00:00
wildmeo+  0.0  19    - futex_    -      -  4843 00:00:00
wildmeo+  0.0  19    - futex_    -      -  4844 00:00:00
wildmeo+  0.0  19    - futex_    -      -  4845 00:00:00
wildmeo+  0.0  19    - futex_    -      -  4846 00:00:00
wildmeo+  0.0  19    - futex_    -      -  4847 00:00:00
wildmeo+  0.0  19    - futex_    -      -  4848 00:00:00
wildmeo+  0.0  19    - futex_    -      -  4849 00:00:00

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;顺便转下16进制方便查询&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;wildmeowth@wildmeowth-VirtualBox:~$ printf &quot;%x\n&quot; 4834
12e2
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;jstack 命令 - jdk 自带jstack 查看Java进程和线程的具体信息&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;jstack 4832 | grep -25 12e2&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;wildmeowth@wildmeowth-VirtualBox:~$ jstack 4832 | grep -25 12e2
2022-03-24 09:23:28

&quot;Finalizer&quot; #3 daemon prio=8 os_prio=0 tid=0x00007f9c4c082000 nid=0x12ec in Object.wait() [0x00007f9c339f8000]
   java.lang.Thread.State: WAITING (on object monitor)
	at java.lang.Object.wait(Native Method)
	- waiting on &amp;lt;0x00000000d6608ee0&amp;gt; (a java.lang.ref.ReferenceQueue$Lock)
	at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:143)
	- locked &amp;lt;0x00000000d6608ee0&amp;gt; (a java.lang.ref.ReferenceQueue$Lock)
	at java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:164)
	at java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:209)

&quot;Reference Handler&quot; #2 daemon prio=10 os_prio=0 tid=0x00007f9c4c07d800 nid=0x12eb in Object.wait() [0x00007f9c33af9000]
   java.lang.Thread.State: WAITING (on object monitor)
	at java.lang.Object.wait(Native Method)
	- waiting on &amp;lt;0x00000000d6606b50&amp;gt; (a java.lang.ref.Reference$Lock)
	at java.lang.Object.wait(Object.java:502)
	at java.lang.ref.Reference.tryHandlePending(Reference.java:191)
	- locked &amp;lt;0x00000000d6606b50&amp;gt; (a java.lang.ref.Reference$Lock)
	at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:153)

&quot;main&quot; #1 prio=5 os_prio=0 tid=0x00007f9c4c00a000 nid=0x12e2 runnable [0x00007f9c542c8000]
   java.lang.Thread.State: RUNNABLE
	at com.wildemeowth.thread.App.main(App.java:23)

&quot;VM Thread&quot; os_prio=0 tid=0x00007f9c4c076000 nid=0x12ea runnable 

JNI global references: 11

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;jps 命令 - 我们也可以用Java 自带的jps 稍加观察&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;可以简单看出是 App类进程搞的坏事&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;wildmeowth@wildmeowth-VirtualBox:~$ jps
4832 App
4859 Jps
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;最后顺便 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kill 4832&lt;/code&gt; 把它杀了&lt;/p&gt;
</description>
        <pubDate>Fri, 04 Jun 2021 10:35:03 +0800</pubDate>
        <link>http://WildMeowth.github.io/2021/06/view-process-and-thread/</link>
        <guid isPermaLink="true">http://WildMeowth.github.io/2021/06/view-process-and-thread/</guid>
        
            
            <category>进程</category>
          
        
        
        <category>Linux</category>
        
      </item>
    
      <item>
        <title>多线程死锁</title>
        <description>&lt;p&gt;说有五个哲学家，围着桌子要吃饭，但桌上只有五根筷子，分别在每个人的左手边和右手边，想要吃上饭，必须要拿到两根筷子凑成一双才行，每次只能拿一根筷子，如下图&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/20210529/eat.png&quot; alt=&quot;eat&quot; /&gt;&lt;/p&gt;

&lt;p&gt;每个哲学家从左边开始拿筷子，拿完拿右边，于是发现每个人只拿了一根筷子。结果就是没有任何一个人能开始吃饭，循环卡在这里了，哲学家们干瞪眼中。。。&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.wildemeowth.thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Chopsticks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;setName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.wildemeowth.thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Philosopher&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leftcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rightcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Philosopher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leftcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rightcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;leftcs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leftcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;rightcs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rightcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;eat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;eat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;leftcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;// TODO Auto-generated catch block&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;get the left chopsticks&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;leftcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rightcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;c1&quot;&gt;// TODO Auto-generated catch block&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;get the second chopsticks start to eat&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rightcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;	
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;com.wildemeowth.thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;App&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cs1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cs2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cs3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cs4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cs5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Chopsticks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		
		&lt;span class=&quot;nc&quot;&gt;Philosopher&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ps1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Philosopher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;nc&quot;&gt;Philosopher&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ps2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Philosopher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;nc&quot;&gt;Philosopher&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ps3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Philosopher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;nc&quot;&gt;Philosopher&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ps4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Philosopher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		&lt;span class=&quot;nc&quot;&gt;Philosopher&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ps5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Philosopher&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cs1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
		
		&lt;span class=&quot;n&quot;&gt;ps1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;ps2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;ps3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;ps4&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;ps5&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;运行结果，所有人都只拿到了一根筷子，吃不上饭了。&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;1get the left chopsticks1
2get the left chopsticks2
3get the left chopsticks3
4get the left chopsticks4
5get the left chopsticks5
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;用jstack 简单查看可确定已经死锁&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;Java stack information for the threads listed above:
===================================================
&quot;Thread-4&quot;:
	at com.wildemeowth.thread.Philosopher.eat(Philosopher.java:30)
	- waiting to lock &amp;lt;0x00000000d66742d0&amp;gt; (a com.wildemeowth.thread.Chopsticks)
	- locked &amp;lt;0x00000000d6674310&amp;gt; (a com.wildemeowth.thread.Chopsticks)
	at com.wildemeowth.thread.Philosopher.run(Philosopher.java:16)
&quot;Thread-0&quot;:
	at com.wildemeowth.thread.Philosopher.eat(Philosopher.java:30)
	- waiting to lock &amp;lt;0x00000000d66742e0&amp;gt; (a com.wildemeowth.thread.Chopsticks)
	- locked &amp;lt;0x00000000d66742d0&amp;gt; (a com.wildemeowth.thread.Chopsticks)
	at com.wildemeowth.thread.Philosopher.run(Philosopher.java:16)
&quot;Thread-1&quot;:
	at com.wildemeowth.thread.Philosopher.eat(Philosopher.java:30)
	- waiting to lock &amp;lt;0x00000000d66742f0&amp;gt; (a com.wildemeowth.thread.Chopsticks)
	- locked &amp;lt;0x00000000d66742e0&amp;gt; (a com.wildemeowth.thread.Chopsticks)
	at com.wildemeowth.thread.Philosopher.run(Philosopher.java:16)
&quot;Thread-2&quot;:
	at com.wildemeowth.thread.Philosopher.eat(Philosopher.java:30)
	- waiting to lock &amp;lt;0x00000000d6674300&amp;gt; (a com.wildemeowth.thread.Chopsticks)
	- locked &amp;lt;0x00000000d66742f0&amp;gt; (a com.wildemeowth.thread.Chopsticks)
	at com.wildemeowth.thread.Philosopher.run(Philosopher.java:16)
&quot;Thread-3&quot;:
	at com.wildemeowth.thread.Philosopher.eat(Philosopher.java:30)
	- waiting to lock &amp;lt;0x00000000d6674310&amp;gt; (a com.wildemeowth.thread.Chopsticks)
	- locked &amp;lt;0x00000000d6674300&amp;gt; (a com.wildemeowth.thread.Chopsticks)
	at com.wildemeowth.thread.Philosopher.run(Philosopher.java:16)

Found 1 deadlock.

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如何解决？
上述例子中，我们发现，哲学家们全体都是左撇子，喜欢先拿左边的筷子。那么我们让其中一部分哲学家变成右撇子会咋样呢。&lt;/p&gt;

&lt;p&gt;想象一下，顺时针顺序下，第一个哲学家是右撇子拿了右手边筷子，他下一步准备拿左手，第二个哲学家左撇子拿了左手筷子，下一步拿他右边筷子，那么第一第二这两位哲学家必然在下一步有一个能拿到第二根筷子于是他吃完了饭，放下了所有筷子。死锁解决。&lt;/p&gt;

&lt;p&gt;改进 Philosopher类 eat 方法&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;eat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;leftcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;c1&quot;&gt;// TODO Auto-generated catch block&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;get the left chopsticks&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;leftcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
			&lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rightcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;c1&quot;&gt;// TODO Auto-generated catch block&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;get the second chopsticks start to eat&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rightcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rightcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;){&lt;/span&gt;
			&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;c1&quot;&gt;// TODO Auto-generated catch block&lt;/span&gt;
				&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
			&lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;get the right chopsticks&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rightcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
			&lt;span class=&quot;kd&quot;&gt;synchronized&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;leftcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
				&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
					&lt;span class=&quot;c1&quot;&gt;// TODO Auto-generated catch block&lt;/span&gt;
					&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
				&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
				&lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;get the second chopsticks start to eat&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;leftcs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
			&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
		&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;奇数右撇子，偶数左撇子。&lt;/p&gt;

</description>
        <pubDate>Sat, 29 May 2021 16:12:31 +0800</pubDate>
        <link>http://WildMeowth.github.io/2021/05/dead-lock-in-thread/</link>
        <guid isPermaLink="true">http://WildMeowth.github.io/2021/05/dead-lock-in-thread/</guid>
        
            
            <category>多线程</category>
          
        
        
        <category>JAVA</category>
        
      </item>
    
      <item>
        <title>Oracle DML 操作的死锁与阻塞</title>
        <description>&lt;p&gt;项目中经常出现数据库阻塞和死锁的情况且数据库DML操作会比较常见，由此引发思考&lt;/p&gt;

&lt;h2 id=&quot;dml-操作&quot;&gt;DML 操作&lt;/h2&gt;
&lt;p&gt;数据库DML 语句常用关键字: insert、update、delete、select等&lt;/p&gt;

&lt;h2 id=&quot;阻塞与死锁&quot;&gt;阻塞与死锁&lt;/h2&gt;
&lt;p&gt;其中insert、update、delete 以及 select for update都会在失误提交或回滚前上锁（表的共享锁，行上的排它锁）&lt;/p&gt;

&lt;p&gt;当事务1一直没提交或回滚，另一个事务2操作同一行时就会等待锁释放而造成阻塞&lt;/p&gt;

&lt;p&gt;而若事务1操作表1行1且未提交或回滚，事务2操作表2行2未提交，此时事务1操作表2行2，事务2操作表1行1，这种互相阻塞的情况就是死锁&lt;/p&gt;

&lt;p&gt;阻塞比死锁还可怕&lt;/p&gt;

&lt;h2 id=&quot;解决思路&quot;&gt;解决思路&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;按同一顺序访问对象&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;如果所有并发事务按同一顺序访问对象，及按顺序申请锁，这样不会相互等待，则发生死锁的可能性降低&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;避免事务中的用户交互&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;避免编写包含用户交互的事务，因为没有用户干预的批处理运行速度远快于等待用户响应时的查询速度&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;保持事务简短（大事务拆小）并处于一个批处理中&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;运行时间越长，等待时间就越长，造成死锁的机会就越高。在同一个事务中尽可能做到一次锁定所有需要的资源，减少死锁概率&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;使用更低级别的隔离级别&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;在业务允许下，尽可能使用较低的隔离级别&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;合理的索引&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;索引不当或索引过少导致全表扫描行级上升表级锁，多个这样的事务执行后，就很容易产生死锁和阻塞&lt;/p&gt;
</description>
        <pubDate>Wed, 03 Jun 2020 11:38:22 +0800</pubDate>
        <link>http://WildMeowth.github.io/2020/06/oracle-optmistic-locking-and-blcoking/</link>
        <guid isPermaLink="true">http://WildMeowth.github.io/2020/06/oracle-optmistic-locking-and-blcoking/</guid>
        
            
            <category>Oracle</category>
          
        
        
        <category>Database</category>
        
      </item>
    
      <item>
        <title>记一次负载测试中出现select for update悲观锁产生的问题</title>
        <description>&lt;p&gt;在一次release 开发过程中, QA team 在做load test 的时候 发现许多库存预存的请求报错。&lt;/p&gt;

&lt;p&gt;db发现有 row lock 的提醒， 技术支持查看Oracle报告时发现另一个release order to dbs(订单release到dbs的系统)的接口中用到了select for update 语句&lt;/p&gt;

&lt;h2 id=&quot;以下是当时的业务逻辑&quot;&gt;以下是当时的业务逻辑&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;The agent &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CatChinaReleaseOrderAgent&lt;/code&gt; start a
A series of tasks are executed include the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FOR UPDATE&lt;/code&gt; SQL and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CATPubRelOrdToIIBSyncService&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;` CATPubRelOrdToIIBSyncService ` will connect to IIB MQ with LDAP username and password.&lt;/li&gt;
  &lt;li&gt;Something wrong with LDAP service and it may cost a lot of time to connect to IIB MQ.&lt;/li&gt;
  &lt;li&gt;` CATPubRelOrdToIIBSyncService ` will be blocked, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FOR UPDATE&lt;/code&gt; will be blocked, so it impact the  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SCWC_SDF_reserveAvailableInventory&lt;/code&gt; API.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;由于一个事务中使用了&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;select for update&lt;/code&gt;, 同一个事务中的另一个同步服务去连接IIB MQ的时候， 由于外部系统网络缓慢，花费了很长的时间连接, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;for update&lt;/code&gt; 长时间row lock. 这时候如果有其他服务调用相同数据，会被长时间阻塞。&lt;/p&gt;

&lt;h2 id=&quot;解决方案&quot;&gt;解决方案&lt;/h2&gt;
&lt;p&gt;事实上技术中心不允许使用 select for update 悲观锁，尤其是在大量业务逻辑的情况下，至于原有业务逻辑可以使用其他处理方案进行替代。如必须使用 select for update，须与架构部讨论后才可使用。&lt;/p&gt;

&lt;p&gt;但由于本案例中的&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FOR UPDATE&lt;/code&gt; 语句所在代码属于IBM 提供的OOTB 代码, 不适合修改， 于是考虑将&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FOR UPDATE&lt;/code&gt; 同一个事务中的后续同步服务改成异步服务， 让它成为新的事务, 不干扰原本事务, 减少&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;FOR UPDATE&lt;/code&gt; 占用时间。本案中将&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CATPubRelOrdToIIBSyncService&lt;/code&gt; 同步改成了  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CATPubRelOrdToIIBAsyncService&lt;/code&gt;异步服务。&lt;/p&gt;
</description>
        <pubDate>Tue, 02 Jun 2020 12:43:11 +0800</pubDate>
        <link>http://WildMeowth.github.io/2020/06/oracle-block/</link>
        <guid isPermaLink="true">http://WildMeowth.github.io/2020/06/oracle-block/</guid>
        
            
            <category>Oracle</category>
          
        
        
        <category>Database</category>
        
      </item>
    
      <item>
        <title>JVM GC 垃圾收集器 （一）</title>
        <description>&lt;p&gt;在了解JVM 的过程中，就不得不提到各代的垃圾收集器。Stop the world。&lt;/p&gt;
&lt;h2 id=&quot;serial--serial-old&quot;&gt;Serial &amp;amp;&amp;amp; Serial Old&lt;/h2&gt;
&lt;p&gt;Serial 和 Serial Old 分别作用于新生代和老年代。属于单线程，在GC时Stop the world，暂停其他线程直至收集结束。&lt;/p&gt;

&lt;p&gt;Serial作用于新生代，由于新生代的对象产生及消逝比较频繁存活少，使用标记Copy 复制算法。&lt;/p&gt;

&lt;p&gt;Serial Old 是作用于老年代存活率高， 老年代的对象使用标记整理算法。&lt;/p&gt;

&lt;p&gt;只能作用小内存(几十-几百M)，不然stop the world时间太长。&lt;/p&gt;

&lt;h2 id=&quot;parallel-scavenge--parallel-old&quot;&gt;Parallel Scavenge &amp;amp;&amp;amp; Parallel Old&lt;/h2&gt;
&lt;p&gt;Parallel Scavenge 多线程并行，作用新生代，复制&lt;/p&gt;

&lt;p&gt;Parallel Old 多线程并行，作用于老年代，标记整理&lt;/p&gt;

&lt;p&gt;jdk1.8 默认&lt;/p&gt;

&lt;p&gt;适用于几百M-两三个G&lt;/p&gt;

&lt;h2 id=&quot;parnew--cms&quot;&gt;ParNew &amp;amp;&amp;amp; CMS&lt;/h2&gt;
&lt;p&gt;ParNew 作用于新生代&lt;/p&gt;

&lt;p&gt;CMS 多线程并发（并发边创建边回收），作用于老年代 标记清除算法 （三色标记）&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;- 初始标记 慢
- 并发标记 快
- 重新标记 慢
- 并发清除 快
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-mermaid&quot;&gt;graph TB
    Root A(黑)--&amp;gt;B（灰）--&amp;gt;C（白）
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;初始标记问题：&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;回收过程中，业务线程突然B到C引用消失，导致本次B回收没被清理（浮动垃圾）&lt;/li&gt;
  &lt;li&gt;回收过程中，业务线程突然从A指向C, B到C的引用突然消失，这时候会把有用的C给清了。大问题&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;解决方案： 通过写屏障增量更新&lt;/p&gt;

&lt;p&gt;但同时增量更新（incremental update）也会有隐蔽问题&lt;/p&gt;

&lt;p&gt;A中两个变量的第一个变量标完标下一个的时候stop the world回来后第一个变量指向C了，标完二变量后A变黑，D有被忽略当成垃圾了&lt;/p&gt;

&lt;p&gt;CMS这一bug在新的G1中解决&lt;/p&gt;

&lt;p&gt;CMS的 remark阶段，必须重头扫描一遍 想解决是stw由于算法bug可能耗时也长&lt;/p&gt;

&lt;p&gt;关于标记清除，复制，标记整理请看&lt;a href=&quot;http://wildmewth.github.io/2018/03/gc-algorithm&quot;&gt;这里&lt;/a&gt;&lt;/p&gt;
</description>
        <pubDate>Sat, 02 Nov 2019 18:52:24 +0800</pubDate>
        <link>http://WildMeowth.github.io/2019/11/jvm-gc/</link>
        <guid isPermaLink="true">http://WildMeowth.github.io/2019/11/jvm-gc/</guid>
        
            
            <category>JVM</category>
          
        
        
        <category>JAVA</category>
        
      </item>
    
      <item>
        <title>Callable + Future 线程异步</title>
        <description>&lt;p&gt;Callable 接口和Runnable 接口相似, 但两者也有很关键的区别. Callable 可以返回结果, Runnable 不会返回结果. 因此相对来说Callable功能更加强大.&lt;/p&gt;

&lt;p&gt;和Runnable的run() 方法类似, Callable有一个Call() 方法, 我们可以先创建一个新的Callable, 然后使用Callable的 call() 方法, 得到返回的结果.&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;before&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;(){&lt;/span&gt;

        &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 可能做一些事情&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Test Callable &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 输出Test Callable Test Callable&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;after&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;after&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;before&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 输出8009&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如上例子, 我们call了名为callable的线程两次, 显而易见第一个System.out.println得到的结果是
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Test Callable Test Callable&lt;/code&gt;
第二个System.out.println得到的结果大约是8000+, 表明运行两次该线程所需要的时间大约是8000+毫秒&lt;/p&gt;

&lt;p&gt;利用Future 也可以得到Callable返回的值, 如下&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;before&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;(){&lt;/span&gt;

        &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 可能做一些事情&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Test Callable&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;ExecutorService&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;threadPool&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Executors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;newSingleThreadExecutor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;future&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;threadPool&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;submit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    
    &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 输出Test Callable Test Callable&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;//System.out.println(callable.call()+callable.call());&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;after&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;after&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;before&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 输出4006&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;此时, 第一个System.out.println依旧得到&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Test Callable Test Callable&lt;/code&gt;
第二个System.out.println得到结果大约为4000+, 表明运行两次线程只需要4000+毫秒, 即两次线程异步执行不会互相干扰。&lt;/p&gt;

&lt;p&gt;ExecutorService继承自Executor，它的目的是为我们管理Thread对象，从而简化并发编程。&lt;/p&gt;

&lt;p&gt;除此之外, FutureTask也可以对Callable 异步获得返回值.&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;before&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;callable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;(){&lt;/span&gt;

        &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 可能做一些事情&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Test Callable&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;FutureTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;future&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FutureTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;callable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 可能做一些事情&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;future&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ExecutionException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;printStackTrace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;kt&quot;&gt;long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;after&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentTimeMillis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;after&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;before&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;// 输出4006&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;FutureTask 实现了Future和Runnable两个接口, 意味着可以同时处理Runnable和Future, 它的好处在于如果有一个返回值计算需要很久, 这个返回值不需要立刻得到, 但线程中其他代码需要被尽快执行的时候, 使用FutureTask, 可以先做其他事, 等到结果计算完了再返回结果。&lt;/p&gt;

</description>
        <pubDate>Wed, 29 Nov 2017 16:12:31 +0800</pubDate>
        <link>http://WildMeowth.github.io/2017/11/callable-future/</link>
        <guid isPermaLink="true">http://WildMeowth.github.io/2017/11/callable-future/</guid>
        
            
            <category>多线程</category>
          
        
        
        <category>JAVA</category>
        
      </item>
    
      <item>
        <title>Spring Protlet MVC - 使用Spring 3 MVC创建一个基本的websphsere portlet</title>
        <description>&lt;h2 id=&quot;摘要&quot;&gt;摘要&lt;/h2&gt;

&lt;p&gt;本文主要介绍&lt;em&gt;IBM Websphere Portal&lt;/em&gt;下使用&lt;em&gt;Spring 3 MVC&lt;/em&gt;创建一个基本的&lt;em&gt;websphsere portlet&lt;/em&gt;.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;创建
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#0&quot;&gt;Portal Project&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;jar包
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#1&quot;&gt;下载jar包&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;配置
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#2.1&quot;&gt;web.xml&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#2.2&quot;&gt;portlet.xml&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#2.3&quot;&gt;applicationContext.xml&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#2.4&quot;&gt;portletname-portlet.xml&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;源码
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#3&quot;&gt;代码&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;正文&quot;&gt;正文&lt;/h2&gt;
&lt;p&gt;&lt;span id=&quot;0&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&quot;0创建一个portal-project&quot;&gt;0.创建一个Portal Project&lt;/h3&gt;

&lt;p&gt;打开&lt;em&gt;Rational Application Developer&lt;/em&gt;, 右键&lt;em&gt;new&lt;/em&gt;一个新的&lt;em&gt;Portal Project&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#jump&quot;&gt;最终目录结构点此跳转.&lt;/a&gt;
&lt;span id=&quot;1&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&quot;1下载jar包&quot;&gt;1.下载jar包&lt;/h3&gt;

&lt;p&gt;首先我们需要下载&lt;em&gt;Spring 3 MVC&lt;/em&gt;所需要的jar包.
&lt;em&gt;Spring 3 MVC Portlet&lt;/em&gt; 所需要的&lt;em&gt;jar&lt;/em&gt;包可以去&lt;a href=&quot;https://spring.io/&quot;&gt;spring官网&lt;/a&gt;下载.&lt;br /&gt;
方便大家下载博主就直接贴出地址如下：&lt;a href=&quot;http://repo.spring.io/release/org/springframework/spring&quot;&gt;http://repo.spring.io/release/org/springframework/spring&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;org.springframework.asm-3.0.4.RELEASE.JAR&lt;/code&gt;&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;org.springframework.beans-3.0.4.RELEASE.JAR&lt;/code&gt;&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;org.springframework.context.support-3.0.4.RELEASE.JAR&lt;/code&gt;&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;org.springframework.context-3.0.4.RELEASE.JAR&lt;/code&gt;&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;org.springframework.core-3.0.4.RELEASE.JAR&lt;/code&gt;&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;org.springframework.expression-3.0.4.RELEASE.JAR&lt;/code&gt;&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;org.springframework.web.portlet-3.0.4.RELEASE.JAR&lt;/code&gt;&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;org.springframework.web.servlet-3.0.4.RELEASE.JAR&lt;/code&gt;&lt;br /&gt;
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;org.springframework.web-3.0.4.RELEASE.JAR&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;将这些&lt;em&gt;jar&lt;/em&gt;包粘贴到&lt;em&gt;portal&lt;/em&gt;项目&lt;em&gt;lib&lt;/em&gt;目录下即可.&lt;/p&gt;

&lt;h3 id=&quot;2配置文件&quot;&gt;2.配置文件&lt;/h3&gt;
&lt;p&gt;&lt;span id=&quot;2.1&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&quot;2-1-配置webxml&quot;&gt;2. 1 配置web.xml&lt;/h4&gt;

&lt;p&gt;和往常一样, &lt;em&gt;SpringMVCPortlet&lt;/em&gt;一样分别设置&lt;em&gt;contextConfigLocation&lt;/em&gt;,&lt;em&gt;ContextLoaderListener&lt;/em&gt;监听器, &lt;em&gt;ViewRendererServlet&lt;/em&gt;视图渲染解析器.&lt;/p&gt;

&lt;p&gt;全部代码如下：&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;web-app&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;WebApp_ID&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;version=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2.5&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://java.sun.com/xml/ns/javaee&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:xsi=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xsi:schemaLocation=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;display-name&amp;gt;&lt;/span&gt;SpringMVCPortlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/display-name&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;context-param&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;param-name&amp;gt;&lt;/span&gt;contextConfigLocation&lt;span class=&quot;nt&quot;&gt;&amp;lt;/param-name&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;param-value&amp;gt;&lt;/span&gt;/WEB-INF/context/applicationContext.xml&lt;span class=&quot;nt&quot;&gt;&amp;lt;/param-value&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/context-param&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;listener&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;listener-class&amp;gt;&lt;/span&gt;org.springframework.web.context.ContextLoaderListener&lt;span class=&quot;nt&quot;&gt;&amp;lt;/listener-class&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/listener&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;ViewRendererServlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet-class&amp;gt;&lt;/span&gt;org.springframework.web.servlet.ViewRendererServlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet-class&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;load-on-startup&amp;gt;&lt;/span&gt;1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/load-on-startup&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet-mapping&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;servlet-name&amp;gt;&lt;/span&gt;ViewRendererServlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet-name&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;url-pattern&amp;gt;&lt;/span&gt;/WEB-INF/servlet/view&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url-pattern&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/servlet-mapping&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;welcome-file-list&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;welcome-file&amp;gt;&lt;/span&gt;index.html&lt;span class=&quot;nt&quot;&gt;&amp;lt;/welcome-file&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;welcome-file&amp;gt;&lt;/span&gt;index.htm&lt;span class=&quot;nt&quot;&gt;&amp;lt;/welcome-file&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;welcome-file&amp;gt;&lt;/span&gt;index.jsp&lt;span class=&quot;nt&quot;&gt;&amp;lt;/welcome-file&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;welcome-file&amp;gt;&lt;/span&gt;default.html&lt;span class=&quot;nt&quot;&gt;&amp;lt;/welcome-file&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;welcome-file&amp;gt;&lt;/span&gt;default.htm&lt;span class=&quot;nt&quot;&gt;&amp;lt;/welcome-file&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;welcome-file&amp;gt;&lt;/span&gt;default.jsp&lt;span class=&quot;nt&quot;&gt;&amp;lt;/welcome-file&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/welcome-file-list&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/web-app&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;p&gt;&lt;span id=&quot;2.2&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&quot;2-2-配置portletxml&quot;&gt;2. 2 配置portlet.xml&lt;/h4&gt;

&lt;p&gt;&lt;em&gt;Spring Portlet MVC&lt;/em&gt;和其&lt;em&gt;Web MVC&lt;/em&gt;可以说是如出一辙,只是在&lt;em&gt;Web MVC&lt;/em&gt;中处于核心的&lt;em&gt;DispatcherServlet&lt;/em&gt;在&lt;em&gt;Portlet MVC&lt;/em&gt;中换成了&lt;em&gt;DispatcherPortlet&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;DispatcherPortlet&lt;/em&gt;配置在&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;portlet.xml&lt;/code&gt;文件中,它继承了&lt;em&gt;Portlet&lt;/em&gt;标准中的&lt;em&gt;GenericPortlet&lt;/em&gt;,所以它本质上是一个能够将&lt;em&gt;Portlet Request dispatch&lt;/em&gt;到&lt;em&gt;Spring&lt;/em&gt;框架中其它&lt;em&gt;MVC&lt;/em&gt;组件的一个&lt;em&gt;Portlet&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;创建&lt;em&gt;portlet&lt;/em&gt;的时候, &lt;em&gt;RAD&lt;/em&gt;会帮你创建一个&lt;em&gt;portlet.xml&lt;/em&gt;文件, 我们只需要对其进行一些配置上的修改就可以了.
把其中的&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;portlet-class&amp;gt;&lt;/code&gt;标签中的值改成&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;org.springframework.web.portlet.DispatcherPortlet&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;全部代码如下：&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet-app&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://java.sun.com/xml/ns/portlet/portlet-app_2_0.xsd&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;version=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2.0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:xsi=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xsi:schemaLocation=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://java.sun.com/xml/ns/portlet/portlet-app_2_0.xsd http://java.sun.com/xml/ns/portlet/portlet-app_2_0.xsd&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;com.ibm.catebizpacustomerselectorwar.CatebizpacustomerselectorwarPortlet.87bcccfd63&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;description&amp;gt;&lt;/span&gt;SpringMVCPortlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet-name&amp;gt;&lt;/span&gt;SpringMVCPortlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portlet-name&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;display-name&amp;gt;&lt;/span&gt;SpringMVCPortlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/display-name&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;display-name&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xml:lang=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;en&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;SpringMVCPortlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/display-name&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet-class&amp;gt;&lt;/span&gt;org.springframework.web.portlet.DispatcherPortlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portlet-class&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;init-param&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;wps.markup&lt;span class=&quot;nt&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;value&amp;gt;&lt;/span&gt;html&lt;span class=&quot;nt&quot;&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;/init-param&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;expiration-cache&amp;gt;&lt;/span&gt;0&lt;span class=&quot;nt&quot;&gt;&amp;lt;/expiration-cache&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;supports&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;mime-type&amp;gt;&lt;/span&gt;text/html&lt;span class=&quot;nt&quot;&gt;&amp;lt;/mime-type&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet-mode&amp;gt;&lt;/span&gt;view&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portlet-mode&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;/supports&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;supported-locale&amp;gt;&lt;/span&gt;en&lt;span class=&quot;nt&quot;&gt;&amp;lt;/supported-locale&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;resource-bundle&amp;gt;&lt;/span&gt;springmvcportlet.nl.HelloWorldPortletResource&lt;span class=&quot;nt&quot;&gt;&amp;lt;/resource-bundle&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet-info&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;SpringMVCPortlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;short-title&amp;gt;&lt;/span&gt;SpringMVCPortlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/short-title&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;keywords&amp;gt;&lt;/span&gt;SpringMVCPortlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/keywords&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portlet-info&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portlet&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;default-namespace&amp;gt;&lt;/span&gt;http://springmvcportlet&lt;span class=&quot;nt&quot;&gt;&amp;lt;/default-namespace&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portlet-app&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;这里以&lt;em&gt;RenderRequest&lt;/em&gt;处理为例,当&lt;em&gt;DispatcherPortlet&lt;/em&gt;接收到&lt;em&gt;Request&lt;/em&gt;的时候,它会根据&lt;em&gt;handermapping&lt;/em&gt;的配置找到相应的&lt;em&gt;Controler&lt;/em&gt;来处理请求. &lt;em&gt;Controler&lt;/em&gt;处理完后返回一个&lt;em&gt;ModelAndView&lt;/em&gt;,对于&lt;em&gt;View&lt;/em&gt;的处理则和&lt;em&gt;Web MVC&lt;/em&gt;类似了,这里不再做介绍.&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;&lt;span id=&quot;2.3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&quot;2-3-创建applicationcontextxml&quot;&gt;2. 3 创建applicationContext.xml&lt;/h4&gt;

&lt;p&gt;根据&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;web.xml&lt;/code&gt;中配置, 在&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;WEB-INF&lt;/code&gt;下创建一个context文件夹, 在其下创建一个&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;applicationContext.xml&lt;/code&gt;的文件, 并写好配置.&lt;/p&gt;

&lt;p&gt;我们可以在&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;applicationContext.xml&lt;/code&gt;中设置HandlerMapping,ViewResolver,Controller等，本例中Controller,HandlerMapping在后面的文件中设置。&lt;/p&gt;

&lt;p&gt;全部代码如下：&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;beans&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.springframework.org/schema/beans&quot;&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;xmlns:xsi=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:context=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.springframework.org/schema/context&quot;&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;xsi:schemaLocation=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

	&lt;span class=&quot;nt&quot;&gt;&amp;lt;context:annotation-config&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Message Source --&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;bean&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;messageSource&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.springframework.context.support.ResourceBundleMessageSource&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;basenames&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;list&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Add appropriate resource properties path --&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;nt&quot;&gt;&amp;lt;value&amp;gt;&lt;/span&gt;springmvcportlet.nl.HelloWorldPortletResource&lt;span class=&quot;nt&quot;&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;/list&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/bean&amp;gt;&lt;/span&gt;
	
	&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Default View Resolver --&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;bean&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;viewResolver&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;cache&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;true&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;viewClass&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;value&amp;gt;&lt;/span&gt;org.springframework.web.servlet.view.JstlView&lt;span class=&quot;nt&quot;&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;prefix&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;value&amp;gt;&lt;/span&gt;/WEB-INF/jsp/&lt;span class=&quot;nt&quot;&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;suffix&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;value&amp;gt;&lt;/span&gt;.jsp&lt;span class=&quot;nt&quot;&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/bean&amp;gt;&lt;/span&gt;
	
	&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Abstract Default Exception Handler --&amp;gt;&lt;/span&gt;
	 &lt;span class=&quot;nt&quot;&gt;&amp;lt;bean&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;defaultExceptionHandlerTemplate&quot;&lt;/span&gt;
		&lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.springframework.web.portlet.handler.SimpleMappingExceptionResolver&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;defaultErrorView&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;DefaultError&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;property&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;exceptionMappings&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;props&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;nt&quot;&gt;&amp;lt;prop&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;key=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;com.ibm.AppException&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;appError&lt;span class=&quot;nt&quot;&gt;&amp;lt;/prop&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;nt&quot;&gt;&amp;lt;/props&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;nt&quot;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/bean&amp;gt;&lt;/span&gt; 
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/bean&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;p&gt;&lt;span id=&quot;2.4&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&quot;2-4-创建springmvcportlet-portletxml&quot;&gt;2. 4 创建SpringMVCPortlet-portlet.xml&lt;/h4&gt;

&lt;p&gt;根据&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;portlet.xml&lt;/code&gt;文件中&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;portlet-name&amp;gt;&lt;/code&gt;标签中的值（例子中是”SpringMVCPortlet”）+”-portlet.xml”为名字创建此文件, 并配置Controller,HandlerMappings.
全部代码如下：&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;beans&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.springframework.org/schema/beans&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:xsi=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:p=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.springframework.org/schema/p&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:context=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.springframework.org/schema/context&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xsi:schemaLocation=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
	
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;context:annotation-config/&amp;gt;&lt;/span&gt;

	&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Controllers --&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;context:component-scan&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;base-package=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;com.wildMeowth.portal.springmvcportlet.controller&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

	&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Handler Mappings --&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;bean&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;org.springframework.web.portlet.mvc.annotation.DefaultAnnotationHandlerMapping&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
	  
	&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Exception Handlers --&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;bean&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;defaultExceptionHandler&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;parent=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;defaultExceptionHandlerTemplate&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
	
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/beans&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;至此, 基本配置完成目录结构如下图: 
&lt;span id=&quot;jump&quot;&gt;&lt;img src=&quot;/assets/images/Bimages/structure.png&quot; alt=&quot;structure&quot; /&gt;&lt;/span&gt;
&lt;span id=&quot;3&quot;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&quot;3代码部分&quot;&gt;3.代码部分&lt;/h3&gt;

&lt;p&gt;在&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;com.wildMeowth.portal.springmvcportlet.controller&lt;/code&gt;包下创建一个类&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SpringMVCPortletController&lt;/code&gt;, 在类中写下如下代码:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nd&quot;&gt;@Controller&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@RequestMapping&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;VIEW&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CusNameDisplayPortletViewController&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

	&lt;span class=&quot;nd&quot;&gt;@RequestMapping&lt;/span&gt;
	&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;handleRenderRequestInternal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;RenderRequest&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RenderResponse&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

		&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;index&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
		
	&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;在jsp目录下创建对应的&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;index.jsp&lt;/code&gt;jsp文件, 如下代码：&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%@ taglib uri=&quot;http://java.sun.com/portlet_2_0&quot; prefix=&quot;portlet&quot;%&amp;gt;
&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot;%&amp;gt;
&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/fmt&quot; prefix=&quot;fmt&quot;%&amp;gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;Hello World&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;启动服务器，最终效果如下图:
&lt;img src=&quot;/assets/images/Bimages/effects.png&quot; alt=&quot;effects&quot; /&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 25 Sep 2017 13:58:12 +0800</pubDate>
        <link>http://WildMeowth.github.io/2017/09/spring3mvc-Portlet-create/</link>
        <guid isPermaLink="true">http://WildMeowth.github.io/2017/09/spring3mvc-Portlet-create/</guid>
        
            
            <category>Webshpere-Portal</category>
          
        
        
        <category>IBM</category>
        
      </item>
    
      <item>
        <title>Websphere portlet间数据传递</title>
        <description>&lt;h2 id=&quot;摘要&quot;&gt;摘要&lt;/h2&gt;

&lt;p&gt;本文主要介绍IBM Websphere Portal中多个portlet间的数据交互. 本文仅介绍其中两种.&lt;/p&gt;

&lt;h2 id=&quot;正文&quot;&gt;正文&lt;/h2&gt;

&lt;h3 id=&quot;1共享呈现参数&quot;&gt;1.共享呈现参数&lt;/h3&gt;

&lt;p&gt;对于共享呈现参数需要在 portlet.xml 部署文件中的&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;portlet-app&amp;gt;&lt;/code&gt;中使用 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;public-render-parameter&amp;gt;&lt;/code&gt; 标签.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet-app&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet-name&amp;gt;&lt;/span&gt;Portlet A&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portlet-name&amp;gt;&lt;/span&gt;
    ...
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/portlet&amp;gt;&lt;/span&gt;
    ...
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;public-render-parameter&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;identifier&amp;gt;&lt;/span&gt;param1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/identifier&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;param1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/qname&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/public-render-parameter&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;public-render-parameter&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;identifier&amp;gt;&lt;/span&gt;param2&lt;span class=&quot;nt&quot;&gt;&amp;lt;/identifier&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;param2&lt;span class=&quot;nt&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/public-render-parameter&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portlet-app&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;然后在每个 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;portlet&amp;gt;&lt;/code&gt; 中使用 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;supported-public-render-parameter&amp;gt;&lt;/code&gt; 标签.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;
&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet-name&amp;gt;&lt;/span&gt;Portlet A&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portle-name&amp;gt;&lt;/span&gt;
    ......
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;supported-public-render-parameter&amp;gt;&lt;/span&gt;param1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/supported-public-render-parameter&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portlet&amp;gt;&lt;/span&gt;    
 
&lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;portlet-name&amp;gt;&lt;/span&gt;Portlet B&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portle-name&amp;gt;&lt;/span&gt;
    ......
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;supported-public-render-parameter&amp;gt;&lt;/span&gt;param1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/supported-public-render-parameter&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/portlet&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;共享呈现参数的使用
与非共享呈现参数的使用方法相同, 共享呈现参数可以通过 ActionResponse 的 setRenderParameter(“key”,”value”) 方法设定, 并通过 RenderRequest 的 getParameter(“key”) 来获得.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;

&lt;p&gt;Portlet A 设定共享呈现参数&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;processAction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;ActionRequest&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actionRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;ActionResponse&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;actionResponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PortletException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;actionResponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setRenderParameter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;param1&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;publicParam&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Portlet B 获取共享呈现参数&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;RenderRequest&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;renderRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;renderResponse&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;renderResponse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PortletException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;IOException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;publicValue&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;renderRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getParameter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;param1&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;以上DONE.&lt;/p&gt;

&lt;h3 id=&quot;2portletsession&quot;&gt;2.PortletSession&lt;/h3&gt;

&lt;p&gt;PortletSession在应用级即PortletSession.APPLICATION_SCOPE, 可以在多个portlet间进行数据共享.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;

&lt;p&gt;Portlet A 中：&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Don't worry, be happy!&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;PortletSession&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;session&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getPortletSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setAttribute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PortletSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;APPLICATION_SCOPE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Portlet B 中：&lt;/p&gt;
&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getPortletSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getAttribute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;PortletSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;APPLICATION_SCOPE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;以上就是在IBM websphere portal中多个portlet间的数据交互的两种方法.&lt;/p&gt;

</description>
        <pubDate>Wed, 09 Aug 2017 16:43:31 +0800</pubDate>
        <link>http://WildMeowth.github.io/2017/08/portlet-data-transfer/</link>
        <guid isPermaLink="true">http://WildMeowth.github.io/2017/08/portlet-data-transfer/</guid>
        
            
            <category>Webshpere-Portal</category>
          
        
        
        <category>IBM</category>
        
      </item>
    
  </channel>
</rss>
